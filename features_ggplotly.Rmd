---
title: "Features by Age and Condition"
author: "Simo"
date: "2024-07-08"
output:
  html_document:
    toc: true
    toc_float: true
    theme: flatly
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE)
library(ggplot2)
library(plotly)
library(dplyr)
library(ggpubr)
library(knitr)
library(DT)
library(data.table)
# Load your data here
results_df <- read.csv("results_df_8Jul2024.csv")
load("31Jul2024.RData")
```

# Clustering Coefficient
```{r Clustering Coefficient, warning=FALSE}
suppressMessages({
p1 <- ggplot(results_df, aes(Age, clustering_coefficient, color = Condition)) +
  # geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  ggtitle("Clustering Coefficient by Age and Condition")
ggplotly(p1)
})

datatable(clustering_coefficient_all_p_values[which(P_value < 0.09)], options = list(
    pageLength = 10,
    autoWidth = TRUE,
    dom = 't'  # This option removes the search box and the pagination controls
  ),
  class = "hover",
  rownames = FALSE
)
```

# Clustering Coefficient RFP
```{r Clustering Coefficient RFP}
suppressMessages({
p2 <- ggplot(results_df, aes(Age, clustering_coefficient_rfp, color = Condition)) +
  # geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  ggtitle("Clustering Coefficient RFP by Age and Condition")
ggplotly(p2)
})

datatable(clustering_coefficient_rfp_p_values[which(P_value < 0.09)], options = list(
    pageLength = 10,
    autoWidth = TRUE,
    dom = 't'  # This option removes the search box and the pagination controls
  ),
  class = "hover",
  rownames = FALSE
)
```

# Global Efficiency
```{r Global Efficiency}
suppressMessages({
p3 <- ggplot(results_df, aes(Age, global_efficiency, color = Condition)) +
  # geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  ggtitle("Global Efficiency by Age and Condition")
ggplotly(p3)
})

datatable(global_efficiency_p_values[which(P_value < 0.09)], options = list(
    pageLength = 10,
    autoWidth = TRUE,
    dom = 't'  # This option removes the search box and the pagination controls
  ),
  class = "hover",
  rownames = FALSE
)
```

# Global Efficiency RFP
```{r Global Efficiency RFP}
suppressMessages({
p4 <- ggplot(results_df, aes(Age, global_efficiency_rfp, color = Condition)) +
  # geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  ggtitle("Global Efficiency RFP by Age and Condition")
ggplotly(p4)
})

datatable(global_efficiency_rfp_p_values[which(P_value < 0.09)], options = list(
    pageLength = 10,
    autoWidth = TRUE,
    dom = 't'  # This option removes the search box and the pagination controls
  ),
  class = "hover",
  rownames = FALSE
)
```

# Frequency Median
```{r Frequency Median}
suppressMessages({
p5 <- ggplot(results_df, aes(Age, frequency_median, color = Condition)) +
  # geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  ggtitle("Frequency Median by Age and Condition")
ggplotly(p5)
})

datatable(frequency_p_values[which(P_value < 0.09)], options = list(
    pageLength = 10,
    autoWidth = TRUE,
    dom = 't'  # This option removes the search box and the pagination controls
  ),
  class = "hover",
  rownames = FALSE
)
```

# Frequency RFP Median
```{r Frequency RFP Median}
suppressMessages({
p6 <- ggplot(results_df, aes(Age, frequency_rfp_median, color = Condition)) +
  # geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  ggtitle("Frequency RFP Median by Age and Condition")
ggplotly(p6)
})

datatable(frequency_rfp_p_values[which(P_value < 0.09)], options = list(
    pageLength = 10,
    autoWidth = TRUE,
    dom = 't'  # This option removes the search box and the pagination controls
  ),
  class = "hover",
  rownames = FALSE
)
```

# Mean Degree
```{r Mean Degree}
suppressMessages({
p7 <- ggplot(results_df, aes(Age, mean_degree, color = Condition)) +
  # geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  ggtitle("Mean Degree by Age and Condition")
ggplotly(p7)
})

datatable(mean_degree_all_p_values[which(P_value < 0.09)], options = list(
    pageLength = 10,
    autoWidth = TRUE,
    dom = 't'  # This option removes the search box and the pagination controls
  ),
  class = "hover",
  rownames = FALSE
)
```

# Mean Degree RFP
```{r Mean Degree RFP}
suppressMessages({
p8 <- ggplot(results_df, aes(Age, mean_degree_rfp, color = Condition)) +
  # geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  ggtitle("Mean Degree RFP by Age and Condition")
ggplotly(p8)
})

datatable(mean_degree_all_rfp_p_values[which(P_value < 0.09)], options = list(
    pageLength = 10,
    autoWidth = TRUE,
    dom = 't'  # This option removes the search box and the pagination controls
  ),
  class = "hover",
  rownames = FALSE
)
```

# Top 5 PC explain ..%.. of the data
```{r PCA, warning=FALSE}
suppressMessages({
p9 <- ggplot(results_df, aes(Age, Top5PC_XVariance, color = Condition)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  ggtitle("Top 5 PC explain x% of data")
ggplotly(p9)
})

# datatable(Top5PC_XVariance_all_p_values[which(P_value < 0.09)], options = list(
#     pageLength = 10,
#     autoWidth = TRUE,
#     dom = 't'  # This option removes the search box and the pagination controls
#   ),
#   class = "hover",
#   rownames = FALSE
# )
```


# Boxplots
```{r Clustering Coefficient boxplot, fig.dim = c(10, 8)}
ggplotly(ggplotly(ggplot(results_df, aes(x = Condition, y = clustering_coefficient, fill = Condition)) +
    geom_boxplot() +
    facet_wrap(vars(Age), scales = "free_y") +
    theme_pubr() +
    labs(title = "Clustering Coefficient across All Conditions and Ages",
         x = "Condition",
         y = "Clustering Coefficient") +
    theme(axis.text.x = element_text(angle = 45, hjust = 1),
          axis.title.x = element_blank())))
ctrl_akt1_hrasv12_clustcoeff.plt
ctrl_akt1_hrasv12_IRF8null_clustcoeff.plt
```
